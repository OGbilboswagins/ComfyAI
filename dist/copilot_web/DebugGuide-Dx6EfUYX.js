function getImportPath(filename) {
            return `./${filename}`;
        }
            import{j as t}from"./vendor-markdown-CBmlBP6m.js";import{r as n}from"./vendor-react-Dixhfmvb.js";import{B as N,g as A,W as m,a as f}from"./message-components-NcjLKGL1.js";const D=({checkpointId:i,onRestore:h})=>{const[l,u]=n.useState(!1),c=async()=>{if(!l){u(!0);try{const s=await m.restoreWorkflowCheckpoint(i),o=s.workflow_data_ui||s.workflow_data;o&&(s.workflow_data_ui?f.loadGraphData(o):f.loadApiJson(o),console.log(`Restored workflow checkpoint ${i}`),h())}catch(s){console.error("Failed to restore checkpoint:",s),alert("Failed to restore workflow checkpoint. Please try again.")}finally{u(!1)}}};return t.jsx("button",{onClick:c,disabled:l,className:`p-1 rounded transition-colors ${l?"text-gray-400 cursor-not-allowed":"text-gray-500 hover:text-blue-600 hover:bg-blue-50"}`,title:`Restore checkpoint ${i}`,children:t.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",className:l?"animate-spin":"",children:[t.jsx("path",{d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"}),t.jsx("path",{d:"M8 4.466V2.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 6.658A.25.25 0 0 1 8 6.466z"})]})})};function J({content:i,name:h="Assistant",avatar:l,onAddMessage:u,onUpdateMessage:c,onFinishLoad:s}){const[o,w]=n.useState(!1),[C,I]=n.useState(""),[R,k]=n.useState(!1),[x,b]=n.useState(null);n.useEffect(()=>{s?.()},[]);const p=n.useMemo(()=>{try{return JSON.parse(i)}catch(e){return console.error("Failed to parse message content:",e),null}},[i]),y=async()=>{if(o)return;const e=A(),r={id:e,role:"ai",content:JSON.stringify({text:`ðŸ” Starting workflow analysis...
`,ext:[]}),format:"markdown",name:"Assistant",finished:!1,debugGuide:!0};u?.(r);try{await j(),await v(e)}finally{w(!1)}},j=async()=>{try{const e=await f.graphToPrompt(),r=localStorage.getItem("sessionId")||"";if(r&&e){const a=await m.saveWorkflowCheckpoint(r,e.output,e.workflow,"debug_start");b(a.version_id),console.log(`Saved debug start checkpoint: ${a.version_id}`)}}catch(e){console.error("Failed to save checkpoint before debug:",e)}},v=async e=>{try{const r=await f.graphToPrompt();let a="",d=null;for await(const g of m.streamDebugAgent(r))if(g.text){a=g.text,g.ext&&(d=g.ext);const S={id:e,role:"ai",content:JSON.stringify({text:a,ext:d||[]}),format:"markdown",name:"Assistant",finished:!1,debugGuide:!0};c?.(S)}c?.({id:e,role:"ai",content:JSON.stringify({text:a,ext:d||[]}),format:"markdown",name:"Assistant",finished:!0,debugGuide:!0})}catch(r){console.error("Error calling debug agent:",r),k(!1);const d={id:e,role:"ai",content:JSON.stringify({text:`I encountered an error while analyzing your workflow: ${r.message||"Unknown error"}`,ext:[]}),format:"markdown",name:"Assistant",finished:!0};c?.(d)}};return p?t.jsx(N,{name:h,children:t.jsxs("div",{className:"bg-gray-100 p-4 rounded-lg",children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsx("p",{className:"text-gray-700 text-sm flex-1",children:p.text}),x&&t.jsx("div",{className:"ml-2 flex-shrink-0",children:t.jsx(D,{checkpointId:x,onRestore:()=>{console.log("Workflow restored from checkpoint")}})})]}),t.jsx("div",{className:"flex mt-4",children:t.jsx("button",{onClick:y,disabled:o,className:`px-4 py-2 text-white text-sm rounded-md transition-colors ${o?"bg-gray-400 cursor-not-allowed":"bg-blue-500 hover:bg-blue-600"}`,children:o?"Analyzing...":"Debug Errors"})})]})}):null}export{J as DebugGuide};
